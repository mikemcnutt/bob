<script>
  const progressFill = document.getElementById('progressFill');

  let xp = 0;
  const xpPerClick = 250;
  const maxXP = 1000;

  function updateProgressBar() {
    const percent = Math.min((xp / maxXP) * 100, 100);
    progressFill.style.width = percent + '%';
    progressFill.setAttribute('aria-valuenow', xp);
    progressFill.textContent = `XP: ${xp} / ${maxXP}`;

    if (percent === 100 && !document.getElementById('marioMessage')) {
      const container = document.querySelector('.container');

      // "Sorry Mario" message
      const msg = document.createElement('p');
      msg.id = 'marioMessage';
      msg.textContent = 'Sorry Mario, but the princess is in another Module Overview';
      msg.style.color = '#fff100';
      msg.style.textAlign = 'center';
      msg.style.marginTop = '20px';
      msg.style.fontSize = '0.9rem';
      container.appendChild(msg);

      // Hint message
      const hint = document.createElement('p');
      hint.textContent = 'Hint: Try the cheat code (↑↑↓↓←→←→B A) to unlock something special!';
      hint.style.color = '#00ffcc';
      hint.style.textAlign = 'center';
      hint.style.marginTop = '10px';
      hint.style.fontSize = '0.8rem';
      container.appendChild(hint);
    }
  }

  function createSaveButton(section) {
    const button = document.createElement('button');
    button.className = 'save-button';
    button.setAttribute('aria-label', 'Save your progress and continue');
    button.textContent = '💾 Save Game';
    let used = false;

    button.addEventListener('click', () => {
      if (used) return;
      used = true;
      xp = Math.min(xp + xpPerClick, maxXP);
      updateProgressBar();
    });

    section.appendChild(button);
  }

  // Cheat code detection
  const cheatSequence = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];
  let cheatIndex = 0;

  window.addEventListener('keydown', (e) => {
    if (e.key === cheatSequence[cheatIndex]) {
      cheatIndex++;
      if (cheatIndex === cheatSequence.length) {
        cheatIndex = 0;

        if (!document.getElementById('wizardMessage')) {
          const container = document.querySelector('.container');

          // Wizard image
          const wizardImg = document.createElement('img');
          wizardImg.src = 'bob.png'; // Replace with the correct path if needed
          wizardImg.alt = 'Wizard holding Bootstrap fire';
          wizardImg.style.display = 'block';
          wizardImg.style.margin = '20px auto 10px';
          wizardImg.style.width = '120px';
          container.appendChild(wizardImg);

          // Cheat message
          const cheatMsg = document.createElement('p');
          cheatMsg.id = 'wizardMessage';
          cheatMsg.innerHTML = `It's dangerous to do Bootstrap alone! Take these links:<br><ul><li><a href='https://getbootstrap.com' target='_blank'>Bootstrap</a></li><li><a href='https://themes.getbootstrap.com/official-themes/' target='_blank'>Bootstrap themes</a></li></ul>`;
          cheatMsg.style.color = '#fff100';
          cheatMsg.style.textAlign = 'center';
          cheatMsg.style.marginTop = '10px';
          cheatMsg.style.fontSize = '0.9rem';
          cheatMsg.setAttribute('aria-live', 'polite');
          container.appendChild(cheatMsg);
        }
      }
    } else {
      cheatIndex = 0;
    }
  });

  // Add save buttons to all sections (except the first)
  document.querySelectorAll('.section').forEach((section, index) => {
    if (index > 0) createSaveButton(section);
  });

  updateProgressBar();
</script>
